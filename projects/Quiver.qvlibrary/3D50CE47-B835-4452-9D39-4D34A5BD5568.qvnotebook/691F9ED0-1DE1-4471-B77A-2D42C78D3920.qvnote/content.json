{
  "title": "Pandas 读|写|用第四列数据替换第三列空位|写mysql",
  "cells": [
    {
      "type": "text",
      "data": "<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;;\"><i>import </i>pandas <i>as </i>pd</p>\n<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;; min-height: 14px;\"><br></p>\n<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;;\"><i>import </i>xlsxwriter</p>\n<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;; min-height: 14px;\"><br></p>\n<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;;\"># <span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">读</span></p>\n<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;;\">df = pd.read_excel<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">(</span>'/Users/widy28/Documents/programs/data_process/9k9<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">商品明细</span>.xlsx'<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">)</span></p>\n<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;; min-height: 14px;\"><br></p>\n<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;;\"># <span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">写</span></p>\n<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;;\">df = pd.DataFrame<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">(</span>write_excel_datas<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">,</span> columns=columns<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">)</span></p>\n<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;;\">now_date = datetime.datetime.now<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">()</span>.strftime<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">(</span>'%m%d'<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">)</span></p>\n<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;;\">writer = pd.ExcelWriter<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">(</span>f'/Users/widy28/Documents/programs/data_process/ddjz/juzi_star{now_date}.xlsx'<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">,</span>&nbsp;</p>\n<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; engine='xlsxwriter'<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">,</span>options={'strings_to_urls': False}<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">)</span></p>\n<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;;\">df.to_excel<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">(</span></p>\n<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;;\">&nbsp; &nbsp; &nbsp; &nbsp; writer<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">,</span>&nbsp;</p>\n<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;;\">&nbsp; &nbsp; &nbsp; &nbsp; index=False</p>\n<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;;\">&nbsp; &nbsp; <span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">)</span></p>\n<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;;\">writer.save<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">()</span></p>\n<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;; min-height: 14px;\"><i></i><br></p>\n<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;.PingFang SC&quot;;\"><span style=\"font-stretch: normal; line-height: normal; font-family: &quot;Helvetica Neue&quot;;\"><i># </i></span>当四级类目为空，取三级类目值</p>\n<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;;\">res = pd.read_excel<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">(</span>'K9<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">高需求补充商品类目</span>.xlsx'<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">)</span></p>\n<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;;\">res_info = res<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">[[</span>'<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">三级类目</span>'<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">,</span> '<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">四级类目</span>'<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">]]</span></p>\n<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;;\">print<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">(</span>res_info<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">)</span></p>\n<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;;\">res_info.loc<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">[</span>res_info<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">[</span>'<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">四级类目</span>'<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">]</span>.isnull<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">(),</span>'<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">四级类目</span>'<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">]</span>=res_info<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">[</span>res_info<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">[</span>'<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">四级类目</span>'<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">]</span>.isnull<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">()][</span>'<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">三级类目</span>'<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">]</span></p>\n<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;;\">print<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">(</span>res_info<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">)</span></p>\n<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;; min-height: 14px;\"><i></i><br></p>"
    },
    {
      "type": "text",
      "data": "<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;;\">pandas&nbsp; use to_sql save to pymysql</p>\n<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;; min-height: 14px;\"><br></p>\n<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;;\">import pandas as pd</p>\n<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;;\">import pymysql</p>\n<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;;\">from sqlalchemy import create_engine</p>\n<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;; min-height: 14px;\"><br></p>\n<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;;\">engine = create_engine<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">(</span>\"mysql+pymysql://USER:PASSWORD@HOST/DATABASE\"<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">)</span></p>\n<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;;\">con = engine.connect<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">()</span></p>\n<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;; min-height: 14px;\"><br></p>\n<p style=\"margin: 0px; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Helvetica Neue&quot;;\">data.to_sql<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">(</span>name='dbtable'<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">,</span> con=engine<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">,</span> if_exists = 'append'<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">,</span> index=False<span style=\"font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;;\">)</span></p>"
    }
  ]
}